<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Esports Platform ER Diagram</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a1a2e;
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 40px;
            font-size: 2.8em;
        }

        .er-diagram {
            position: relative;
            width: 100%;
            height: 1000px;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            overflow: visible;
        }

        .entity {
            position: absolute;
            background: white;
            border: 3px solid;
            border-radius: 12px;
            padding: 15px;
            min-width: 180px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            z-index: 10;
        }

        .entity h3 {
            text-align: center;
            margin-bottom: 12px;
            font-size: 1.4em;
            font-weight: bold;
            padding-bottom: 8px;
            border-bottom: 2px solid currentColor;
        }

        .entity-attributes {
            font-size: 0.9em;
            line-height: 1.5;
        }

        .pk { 
            font-weight: bold; 
            text-decoration: underline;
            color: #e74c3c;
        }
        .fk { 
            font-style: italic; 
            color: #3498db;
        }
        .attribute {
            margin: 3px 0;
            padding: 2px 5px;
            background: #f8f9fa;
            border-radius: 4px;
        }

        /* Entity Colors */
        .player { 
            border-color: #3498db; 
            top: 50px; 
            left: 100px;
        }
        .player h3 { color: #3498db; }

        .team { 
            border-color: #e74c3c; 
            top: 50px; 
            left: 450px;
        }
        .team h3 { color: #e74c3c; }

        .organization { 
            border-color: #9b59b6; 
            top: 50px; 
            left: 800px;
        }
        .organization h3 { color: #9b59b6; }

        .tournament { 
            border-color: #f39c12; 
            top: 400px; 
            left: 300px;
        }
        .tournament h3 { color: #f39c12; }

        .match { 
            border-color: #27ae60; 
            top: 700px; 
            left: 500px;
        }
        .match h3 { color: #27ae60; }

        /* Relationship Lines */
        .relationship {
            position: absolute;
            z-index: 5;
        }

        .arrow {
            stroke: #34495e;
            stroke-width: 3;
            fill: none;
            marker-end: url(#arrowhead);
        }

        .arrow.one-to-many {
            stroke: #e74c3c;
            stroke-width: 3;
        }

        .arrow.many-to-many {
            stroke: #9b59b6;
            stroke-width: 3;
            stroke-dasharray: 8,4;
        }

        .arrow.one-to-one {
            stroke: #27ae60;
            stroke-width: 3;
        }

        .relationship-label {
            position: absolute;
            background: white;
            padding: 4px 8px;
            border: 1px solid #34495e;
            border-radius: 6px;
            font-size: 0.8em;
            font-weight: bold;
            color: #2c3e50;
            white-space: nowrap;
            z-index: 15;
        }

        .cardinality {
            position: absolute;
            font-size: 0.9em;
            font-weight: bold;
            color: #e74c3c;
            background: white;
            padding: 2px 6px;
            border-radius: 4px;
            z-index: 15;
        }

        /* Legend */
        .legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 2px solid #34495e;
            border-radius: 10px;
            padding: 15px;
            z-index: 20;
            min-width: 200px;
        }

        .legend h4 {
            margin-bottom: 10px;
            color: #2c3e50;
            text-align: center;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
            font-size: 0.9em;
        }

        .legend-line {
            width: 30px;
            height: 3px;
            margin-right: 10px;
            border-radius: 2px;
        }

        .one-to-many-legend { background: #e74c3c; }
        .many-to-many-legend { 
            background: #9b59b6; 
            background-image: repeating-linear-gradient(45deg, transparent, transparent 4px, white 4px, white 8px);
        }
        .one-to-one-legend { background: #27ae60; }

        /* Data Flow Section */
        .data-flow {
            margin-top: 40px;
            background: #2c3e50;
            color: white;
            padding: 30px;
            border-radius: 15px;
        }

        .data-flow h2 {
            text-align: center;
            margin-bottom: 25px;
            color: #ecf0f1;
        }

        .flow-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .flow-step {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid #3498db;
        }

        .flow-step h3 {
            color: #74b9ff;
            margin-bottom: 12px;
        }

        .flow-step p {
            line-height: 1.6;
            color: #bdc3c7;
        }

        /* Key Constraints */
        .constraints {
            margin-top: 30px;
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #e9ecef;
        }

        .constraints h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
        }

        .constraint-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }

        .constraint {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #e74c3c;
        }

        .constraint h4 {
            color: #e74c3c;
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üóÑÔ∏è Esports Platform Entity-Relationship Diagram</h1>
        
        <div class="er-diagram">
            <!-- SVG for arrows -->
            <svg width="100%" height="100%" style="position: absolute; top: 0; left: 0; z-index: 5;">
                <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
                            refX="10" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#34495e" />
                    </marker>
                </defs>

                <!-- Player to Team: Many-to-One (players ‚Üí team.captain) -->
                <path d="M 280 120 Q 350 120 420 120" class="arrow one-to-many" />
                
                <!-- Team to Player: One-to-Many (team ‚Üí players[]) -->
                <path d="M 420 140 Q 350 140 280 140" class="arrow one-to-many" />
                
                <!-- Organization to Team: One-to-Many -->
                <path d="M 770 120 Q 700 120 630 120" class="arrow one-to-many" />
                
                <!-- Organization to Player: Many-to-One (owner) -->
                <path d="M 770 100 Q 500 80 280 100" class="arrow one-to-one" />
                
                <!-- Tournament to Team: Many-to-Many -->
                <path d="M 400 400 Q 400 300 550 180" class="arrow many-to-many" />
                
                <!-- Tournament to Match: One-to-Many -->
                <path d="M 450 520 Q 500 600 550 680" class="arrow one-to-many" />
                
                <!-- Match to Team: Many-to-Many -->
                <path d="M 550 700 Q 400 600 500 200" class="arrow many-to-many" />
                
                <!-- Match to Player: Many-to-Many (through team participation) -->
                <path d="M 500 700 Q 300 500 200 200" class="arrow many-to-many" />
            </svg>

            <!-- Entities -->
            <div class="entity player">
                <h3>PLAYER</h3>
                <div class="entity-attributes">
                    <div class="attribute pk">_id (ObjectId)</div>
                    <div class="attribute">username (unique)</div>
                    <div class="attribute">email (unique)</div>
                    <div class="attribute">inGameName</div>
                    <div class="attribute">primaryGame</div>
                    <div class="attribute">earnings</div>
                    <div class="attribute">aegisRating</div>
                    <div class="attribute">teamStatus</div>
                </div>
            </div>

            <div class="entity team">
                <h3>TEAM</h3>
                <div class="entity-attributes">
                    <div class="attribute pk">_id (ObjectId)</div>
                    <div class="attribute">teamName (unique)</div>
                    <div class="attribute">tag (unique)</div>
                    <div class="attribute fk">captain ‚Üí Player._id</div>
                    <div class="attribute fk">players[] ‚Üí Player._id</div>
                    <div class="attribute fk">organization ‚Üí Org._id</div>
                    <div class="attribute">totalEarnings</div>
                    <div class="attribute">aegisRating</div>
                </div>
            </div>

            <div class="entity organization">
                <h3>ORGANIZATION</h3>
                <div class="entity-attributes">
                    <div class="attribute pk">_id (ObjectId)</div>
                    <div class="attribute">orgName (unique)</div>
                    <div class="attribute fk">owner ‚Üí Player._id</div>
                    <div class="attribute fk">teams[] ‚Üí Team._id</div>
                    <div class="attribute">totalEarnings</div>
                    <div class="attribute">activeGames[]</div>
                </div>
            </div>

            <div class="entity tournament">
                <h3>TOURNAMENT</h3>
                <div class="entity-attributes">
                    <div class="attribute pk">_id (ObjectId)</div>
                    <div class="attribute">tournamentName (unique)</div>
                    <div class="attribute">slug (unique)</div>
                    <div class="attribute">participatingTeams[]</div>
                    <div class="attribute fk">‚îî‚îÄ team ‚Üí Team._id</div>
                    <div class="attribute">phases[]</div>
                    <div class="attribute fk">‚îî‚îÄ matches[] ‚Üí Match._id</div>
                    <div class="attribute">prizePool</div>
                </div>
            </div>

            <div class="entity match">
                <h3>MATCH</h3>
                <div class="entity-attributes">
                    <div class="attribute pk">_id (ObjectId)</div>
                    <div class="attribute">matchNumber</div>
                    <div class="attribute fk">tournament ‚Üí Tournament._id</div>
                    <div class="attribute">participatingTeams[]</div>
                    <div class="attribute fk">‚îî‚îÄ team ‚Üí Team._id</div>
                    <div class="attribute fk">‚îî‚îÄ players[].player ‚Üí Player._id</div>
                    <div class="attribute">map</div>
                    <div class="attribute">matchStats</div>
                </div>
            </div>

            <!-- Relationship Labels -->
            <div class="relationship-label" style="top: 110px; left: 340px;">captain</div>
            <div class="relationship-label" style="top: 130px; left: 340px;">roster</div>
            <div class="relationship-label" style="top: 110px; left: 700px;">owns</div>
            <div class="relationship-label" style="top: 90px; left: 500px;">owner</div>
            <div class="relationship-label" style="top: 300px; left: 470px;">participates</div>
            <div class="relationship-label" style="top: 600px; left: 470px;">contains</div>
            <div class="relationship-label" style="top: 450px; left: 380px;">competes</div>
            <div class="relationship-label" style="top: 350px; left: 250px;">plays</div>

            <!-- Cardinalities -->
            <div class="cardinality" style="top: 105px; left: 250px;">N</div>
            <div class="cardinality" style="top: 105px; left: 420px;">1</div>
            <div class="cardinality" style="top: 125px; left: 420px;">1</div>
            <div class="cardinality" style="top: 125px; left: 310px;">N</div>
            <div class="cardinality" style="top: 105px; left: 630px;">N</div>
            <div class="cardinality" style="top: 105px; left: 770px;">1</div>
            <div class="cardinality" style="top: 520px; left: 420px;">1</div>
            <div class="cardinality" style="top: 680px; left: 520px;">N</div>

            <!-- Legend -->
            <div class="legend">
                <h4>Relationship Types</h4>
                <div class="legend-item">
                    <div class="legend-line one-to-many-legend"></div>
                    <span>One-to-Many</span>
                </div>
                <div class="legend-item">
                    <div class="legend-line many-to-many-legend"></div>
                    <span>Many-to-Many</span>
                </div>
                <div class="legend-item">
                    <div class="legend-line one-to-one-legend"></div>
                    <span>One-to-One</span>
                </div>
                <hr style="margin: 10px 0;">
                <div style="font-size: 0.8em;">
                    <div><strong>PK:</strong> Primary Key</div>
                    <div><strong>FK:</strong> Foreign Key</div>
                </div>
            </div>
        </div>

        <!-- Data Flow Process -->
        <div class="data-flow">
            <h2>üìä Data Flow Process</h2>
            <div class="flow-steps">
                <div class="flow-step">
                    <h3>1. Player Registration</h3>
                    <p>New players create accounts with unique username/email. They set gaming preferences, roles, and availability status.</p>
                </div>
                
                <div class="flow-step">
                    <h3>2. Team Formation</h3>
                    <p>Players form teams with one designated captain. Captain reference is stored, and players[] array contains team roster ObjectIds.</p>
                </div>
                
                <div class="flow-step">
                    <h3>3. Organization Ownership</h3>
                    <p>Organizations can acquire teams. The owner field references a Player, and teams[] array tracks all owned teams.</p>
                </div>
                
                <div class="flow-step">
                    <h3>4. Tournament Creation</h3>
                    <p>Tournaments are created with participating teams. Each team entry includes qualification method and group assignment.</p>
                </div>
                
                <div class="flow-step">
                    <h3>5. Match Execution</h3>
                    <p>Matches reference the parent tournament and store detailed team/player performance data, including kills, damage, and placement.</p>
                </div>
                
                <div class="flow-step">
                    <h3>6. Statistics Aggregation</h3>
                    <p>Match results flow back to update player earnings, team ratings, tournament standings, and organization total earnings.</p>
                </div>
            </div>
        </div>

        <!-- Key Constraints -->
        <div class="constraints">
            <h2>üîí Key Business Rules & Constraints</h2>
            <div class="constraint-grid">
                <div class="constraint">
                    <h4>Unique Identifiers</h4>
                    <p>Players: username & email must be unique<br>
                    Teams: teamName & tag must be unique<br>
                    Tournaments: tournamentName & slug must be unique</p>
                </div>
                
                <div class="constraint">
                    <h4>Team Composition</h4>
                    <p>Each team has exactly 1 captain<br>
                    Teams can have multiple players (typically 4-5 for BGMI)<br>
                    Captain must also be in players[] array</p>
                </div>
                
                <div class="constraint">
                    <h4>Tournament Structure</h4>
                    <p>Tournaments have phases (qualifiers ‚Üí finals)<br>
                    Each phase contains multiple matches<br>
                    Teams participate through qualification methods</p>
                </div>
                
                <div class="constraint">
                    <h4>Match Participation</h4>
                    <p>Matches store snapshot data of team/player names<br>
                    Up to 16 teams per match<br>
                    Detailed performance tracking per player</p>
                </div>
                
                <div class="constraint">
                    <h4>Ownership Rules</h4>
                    <p>Organizations owned by exactly 1 player<br>
                    Teams optionally belong to 1 organization<br>
                    Earnings aggregate from teams to organization</p>
                </div>
                
                <div class="constraint">
                    <h4>Data Integrity</h4>
                    <p>All ObjectId references maintain referential integrity<br>
                    Embedded arrays store both reference and snapshot data<br>
                    Calculated fields auto-update via middleware</p>
                </div>
            </div>
        </div>
    </div>
</body>
</html>